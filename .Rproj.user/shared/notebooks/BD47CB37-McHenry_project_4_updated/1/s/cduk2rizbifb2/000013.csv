"0","#| label: Division Play"
"0","#| include: true"
"0","#| echo: false"
"0","#| warning: false"
"0",""
"0","# Include just games played against Flyers divisional rivals"
"0","division <- game_all_season |>"
"0","  filter(opposingTeam == ""NYR"" | opposingTeam == ""PIT"" | opposingTeam == ""NYI"" | opposingTeam == ""WSH"" | opposingTeam == ""CAR"" | opposingTeam == ""CBJ"" | opposingTeam == ""N.J"" | opposingTeam == ""NJD"") |>"
"0","  select(gameDate, season, season_num, opposingTeam, W, L, OT, P) |>"
"0","  mutate("
"0","    points = cumsum(P),"
"0","    poss_points = 2"
"0","  ) |>"
"0","  group_by(season_num, season) |>"
"0","  summarize("
"0","    points = sum(P),"
"0","    poss_points = sum(poss_points),"
"0","    Wins = sum(W),"
"0","    Losses = sum(L),"
"0","    OTL = sum(OT)"
"0","  ) |>"
"0","  mutate("
"0","    points_percentage = 100 * (points / poss_points),"
"0","    games_with_points = Wins + OTL"
"0","  ) |>"
"0","  pivot_longer("
"0","    cols = Wins:OTL,"
"0","    names_to = ""Result"","
"0","    values_to = ""Record"""
"0","  )"
"2","`summarise()` has grouped output by 'season_num'. You can override using the `.groups` argument."
"0","points_labels <- division |>"
"0","  group_by(season_num, season) |>"
"0","  summarize("
"0","    games = sum(Record),"
"0","    games_with_points = mean(games_with_points, na.rm = TRUE),"
"0","    points_percentage = mean(points_percentage, na.rm = TRUE)"
"0","  )"
"2","`summarise()` has grouped output by 'season_num'. You can override using the `.groups` argument."
"0","ggplot(data = division, aes(x = season, y = Record, fill = Result, alpha = Result)) +"
"0","  geom_bar(stat = ""identity"", color = ""black"") +"
"0","  scale_fill_manual(values = c(""white"", ""black"", ""orange"")) +"
"0","  scale_alpha_manual(values = c(0.1, 1, 1)) +"
"0","  scale_y_continuous("
"0","    limits = c(0, 45),"
"0","    breaks = seq(0, 45, 9),"
"0","    expand = c(0, 0)"
"0","  ) +"
"0","  scale_x_continuous(breaks = seq(2008, 2023, 2)) +"
"0","  labs("
"0","    title = ""Divisional Play Breakdown and Points Percentage"","
"0","    x = ""Season"","
"0","    y = ""Games"","
"0","    caption = ""Note: Labels in each bar represent points percentage against divisional rivals."""
"0","  ) +"
"0","  theme_test() +"
"0","  geom_text("
"0","    data = points_labels,"
"0","    aes(x = season, y = games_with_points, label = format(round(points_percentage, 1), nsmall = 1)), inherit.aes = FALSE,"
"0","    vjust = -1,"
"0","    size = 3.5"
"0","  ) +"
"0","  theme(plot.caption = element_text(hjust = 0))"
