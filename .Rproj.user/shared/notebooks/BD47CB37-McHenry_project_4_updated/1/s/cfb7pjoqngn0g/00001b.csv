"0","#| label: Goals Across Seasons"
"0","#| include: true"
"0","#| echo: false"
"0","#| warning: false"
"0",""
"0","game_all_season |>"
"0","  filter(games_played <= curr_games) |>"
"0","  group_by(season_num, season) |>"
"0","  summarize(goalsFor = sum(goalsFor),"
"0","            goalsAgainst = sum(goalsAgainst)) |>"
"0","  pivot_longer(cols = goalsFor:goalsAgainst,"
"0","               names_to = ""Result"","
"0","               values_to = ""Goals"") |>"
"0","  mutate(Result = case_when("
"0","    Result == ""goalsFor"" ~ ""Goals For"","
"0","    Result == ""goalsAgainst"" ~ ""Goals Against"""
"0","  )) |>"
"0","  mutate(playoffs = case_when("
"0","    season_num == 1 ~ ""Made Playoffs"","
"0","    season_num == 2 ~ ""Made Playoffs"","
"0","    season_num == 3 ~ ""Made Playoffs"","
"0","    season_num == 4 ~ ""Made Playoffs"","
"0","    season_num == 5 ~ ""Did Not Make Playoffs"","
"0","    season_num == 6 ~ ""Made Playoffs"","
"0","    season_num == 7 ~ ""Did Not Make Playoffs"","
"0","    season_num == 8 ~ ""Made Playoffs"","
"0","    season_num == 9 ~ ""Did Not Make Playoffs"","
"0","    season_num == 10 ~ ""Made Playoffs"","
"0","    season_num == 11 ~ ""Did Not Make Playoffs"","
"0","    season_num == 12 ~ ""Made Playoffs"","
"0","    season_num == 13 ~ ""Did Not Make Playoffs"","
"0","    season_num == 14 ~ ""Did Not Make Playoffs"","
"0","    season_num == 15 ~ ""Did Not Make Playoffs"","
"0","    season_num == 16 ~ ""TBD"""
"0","  )) |>"
"0","  ggplot(aes(x = season, y = Goals, color = Result)) +"
"0","  geom_line() +"
"0","  scale_color_manual(values = c(""black"", ""orange"")) +"
"0","    scale_y_continuous("
"0","    limits = c(50, 100),"
"0","    breaks = seq(50, 100, 10),"
"0","    expand = c(0, 0)"
"0","  ) +"
"0","  scale_x_continuous(breaks = seq(2008, 2023, 2)) +"
"0","  labs(title = paste0(""Goals For and Against "", curr_games, "" Games Into Season""),"
"0","       x = ""Season"","
"0","       y = ""Goals"") +"
"0","  theme_test() +"
"0","  theme(legend.title = element_blank())"
"2","`summarise()` has grouped output by 'season_num'. You can override using the `.groups` argument."
